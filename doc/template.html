<div id="body" style="max-width:88ex;margin:auto">
<h2>Hydrogen Templates</h2><pre>def H _
  case _
  when Hash then
    '&lt;'+(_[:_]||:div).to_s+(_.keys-[:_,:c]).map{|a|
      ' '+a.to_s+'='+&quot;'&quot;+
      _[a].to_s.hsub({&quot;'&quot;=&gt;'%27',
                       '&gt;'=&gt;'%3E',
                       '&lt;'=&gt;'%3C'})+&quot;'&quot;}.join+'&gt;'+
      (_[:c] ? (H _[:c]) : '')+
      '&lt;/'+(_[:_]||:div).to_s+'&gt;'
  when Array then
    _.map{|n|H n}.join\
  else
    _.to_s
  end
end

</pre>
<p>this is sort of an anti-template-language. some allow you to write pretty
code - but after a few rounds of learning all the syntactic subtleties of
another language, scrounge around for tricks to do some subset of control
structures, trying to get your editor add-on properly highlighting the embedded
code-within-code, inventing caching schemes to avoid running an
almost-turing-complete
language-implemented-in-slow-scripting-language-of-choice, familiarizing
yourself with said mountain of code so you can create a patch when something
breaks, i wrote this</p>
<p>the example here is rewriting BBC News' content to avoid scanning all over
the page with a nonsensical hodpodge of random squares &amp; whitespace,
missing article descriptions, massive-icon sidebars and so on. i used element
to do on-the-fly <a href="http://repo.or.cz/w/element.git/blob/HEAD:/ruby/W/feed.rb">feedparsing</a> and
model generation..</p>
<p><a href="http://element.rubyforge.org/git?p=element.git;a=blob;f=ruby/H.rb;"><img src="http://blog.whats-your.name/public/bbc1.png" alt="" /></a></p>
<p>Hash literals are elements, if you don't provide a tagname, it defaults to
divs, attributes work as expected Arrays can contain Arrays, Hashes, or
strings.. Strings allow you to drop down to retro HTML if youre in the mood, i
did here:</p>
<p><img src="http://blog.whats-your.name/public/bbc2.png" alt="" /></p>
<p>not quite as pretty as Haml, but definitely blazing fast and trivial to port
to new languages (with at least Record/Hash/Table and Array constructors) in a
few minutes</p>
<p><img src="http://blog.whats-your.name/public/bbc3.png" alt="" /></p>
